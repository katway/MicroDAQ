CREATE VIEW [dbo].[v_remoteControl] AS SELECT     CAST(slave AS int) AS id, ISNULL(cycle, 0) AS cycle, ISNULL(command, 0) AS command, ISNULL(cmdstate, 0) AS cmdstateFROM         dbo.RemoteControlWHERE     (slave IS NOT NULL)UNIONSELECTc.id, (cycle & pr.alertBuzzer) as cycle,command,cmdStateFROM(SELECTid as id,MAX(cycle) AS cycle,MIN(command) AS command,MIN(cmdstate) AS cmdStateFROM(SELECT     p.alarm AS id,  m.alert AS cycle, 1 AS command, 1 AS cmdStateFROM         dbo.meters_value m INNER JOIN                      dbo.ProcessItem p ON m.id = p.slave) bGROUP BY B.idHAVING B.ID IS NOT NULL) c LEFT JOIN  dbo.ProcessItem pr ON c.id = pr.slaveGO